
(function(option){var _doc=document,_urlparam=null;_host='';_proto='http:',_path='/cgi-bin/qzshare/cgi_qzshare_onekey',_maxDescLength=122,_minSelectionStrLength=3,_imgSharePadX=5,_imgSharePadY=5,_dragSharePadX=5,_dragSharePadY=20,_clickSendRate=0.05,_showPvSendRate=0.05,_drag_pick_op_name='drag_pick',_img_pick_op_name='img_pick',_style='';_bgp2='http://qzonestyle.gtimg.cn/qzone/app/qzlike/imgs/open_share_button_widget.png?max_age=19830211&d=1128113721',_bgp3='http://qzonestyle.gtimg.cn/qzone/app/qzlike/imgs/open_share_icon_widget.png?max_age=19830211&d=1128113730',_shareButtonStyle={101:{bgp:_bgp2,width:120,height:24,bgposX:-21,bgposY:-0},102:{bgp:_bgp2,width:63,height:24,bgposX:-21,bgposY:-25},103:{bgp:_bgp2,width:50,height:16,bgposX:-99,bgposY:-25},201:{bgp:_bgp3,width:32,height:32,bgposX:-14,bgposY:-0},202:{bgp:_bgp3,width:24,height:24,bgposX:-14,bgposY:-33},203:{bgp:_bgp3,width:16,height:16,bgposX:-53,bgposY:-34},zIndex:9999},_nowSelectionText='',_currentMouseOverTarget=null,_dragShareButton=null,_imgShareButton=null,_textSearchRngReg='',_imgSearchRngReg='',Tool={array:{filter:function(func,scope){scope=scope||this;var list=[];for(var i=0;i<scope.length;i++){func.call(scope,scope[i],i)&&list.push(scope[i]);}
return list;}},object:{getType:function(obj){return obj===null?'null':(obj===undefined?'undefined':Object.prototype.toString.call(obj).slice(8,-1).toLowerCase());}},dom:(function(){var doc=document,de=doc.documentElement,win=window,isReady=false,op={};var ready=function(){if(isReady)
return;if(!doc.body){return setTimeout(ready,1);}
isReady=true;ready.callBack();}
var onDomReady=function(cb){ready.callBack=cb;if(doc.readyState==="complete"){return setTimeout(ready,1);}
if(doc.addEventListener){doc.addEventListener('DOMContentLoaded',function(){doc.removeEventListener('DOMContentLoaded',arguments.callee,false);ready();},false);win.addEventListener("load",ready,false);}else{if(doc.attachEvent){doc.attachEvent('onreadystatechange',function(){if(doc.readyState==="complete"){doc.detachEvent("onreadystatechange",arguments.callee);ready();}})
win.attachEvent("onload",ready);function scrollCheck(){try{de.doScroll('left');}catch(e){setTimeout(scrollCheck,10);return;}
ready();}
var topLev=false;try{topLev=win.frameElement==null;}catch(e){}
if(topLev&&de.doScroll){scrollCheck();}}else{win.onload=ready;}}}
var addEvent=function(element,eventType,handler){if(document.addEventListener){element.addEventListener(eventType,handler,false);}else if(document.attachEvent){element.attachEvent('on'+eventType,handler);}};var removeEvent=function(element,eventType,handler){if(document.removeEventListener){element.removeEventListener(eventType,handler,false);}else if(document.detachEvent){element.detachEvent('on'+eventType,handler);}};var contains=doc.compareDocumentPosition?function(a,b){return a.compareDocumentPosition(b)&16;}:function(a,b){return a!==b&&(a.contains?a.contains(b):true);};var isAncestor=function(a,b){return a&&b&&a!=b&&contains(a,b);};var searchChain=function(elem,prop,func){prop=prop||'parentNode';while(elem){if(!func||func.call(elem,elem)){return elem;}
elem=elem[prop];}
return null;};return{onDomReady:onDomReady,addEvent:addEvent,removeEvent:removeEvent,isAncestor:isAncestor,contains:contains,searchChain:searchChain}})()},TCISD={sendPV:function(url){var pvid=(Math.round(Math.random()*2147483647)*(new Date().getUTCMilliseconds()))%10000000000;var rt=Math.random();var src=" http://pingfore.qq.com/pingd?dm=sns.qzone.qq.com&url="+url+"&tt=-&rdm=-&rurl=-&pvid="+pvid+"&scr=-&scl=-&lang=-&java=1&cc=-&pf=-&tz=-8&ct=-&vs=3.3&rt="+rt;window.__pgvImg=new Image();window.__pgvImg.src=src;},sendPingHot:function(hottag){window.__pinghotImg=new Image();var src='http://pinghot.qq.com/pingd?dm=sns.qzone.qq.com.hot&url='+location.pathname+'&hottag='+hottag+'&hotx=9999&hoty=9999&rand='+Math.round(Math.random()*100000);window.__pinghotImg.src=src;}};var getSearchStr=function(o){var str='';for(var i in o){str+=i+' ';}
return str;};var upDate=function(op){option=op||option;_urlparam={url:option.url||location.href,desc:option.desc,summary:option.summary,title:option.title,site:option.site,pics:option.pics},_host=option.pengyou?'ishare.pengyou.com':'sns.qzone.qq.com';var ip=option[_img_pick_op_name],dp=option[_drag_pick_op_name];ip=Tool.object.getType(ip)=='object'?ip:!!ip?{}:ip;dp=Tool.object.getType(dp)=='object'?dp:!!dp?{}:dp;_textSearchRngReg=getSearchStr(dp);_imgSearchRngReg=getSearchStr(ip);if(ip){Tool.dom.addEvent(_doc,'mouseover',_onMouseOver);_imgShareButton=_imgShareButton||new ShareButton();_imgShareButton.setStyle(_shareButtonStyle[ip['@style']||102]);_imgShareButton.setUrlParam();}else{_imgShareButton&&_imgShareButton.hide();Tool.dom.removeEvent(_doc,'mouseover',_onMouseOver);}
if(dp){_dragShareButton=_dragShareButton||new ShareButton();_dragShareButton.setStyle(_shareButtonStyle[dp['@style']||102]);_dragShareButton.setUrlParam();Tool.dom.addEvent(_doc,'mouseup',_onMouseUp);Tool.dom.addEvent(_doc,'mousedown',_onMouseDown);}else{_dragShareButton&&_dragShareButton.hide();Tool.dom.removeEvent(_doc,'mouseup',_onMouseUp);Tool.dom.removeEvent(_doc,'mousedown',_onMouseDown);}};var checkInRange=function(node){if(!node)return false;for(var i=_contentArea.length-1;i>=0;i--){if(Tool.dom.isAncestor(_contentArea[i],node)||_contentArea[i]==node)return true;}
return false;};var checkInArea=function(node,searchStr){if(!node)return false;searchStr=' '+searchStr+' ';var cls=[],clsV,ic=0,rv=null;Tool.dom.searchChain(node,'parentNode',function(n){if(n.id&&searchStr.indexOf(' #'+n.id+' ')>-1){rv='#'+n.id;}else if(n.className&&(cls=Tool.array.filter(function(v){if(!!v&&searchStr.indexOf(' .'+v+' ')>-1){++ic==1?(clsV=v):null;return true;}
else
return false;},n.className.split(' '))).length>=1){rv='.'+clsV;}else if(n.tagName&&searchStr.toLowerCase().indexOf(' '+n.tagName.toLowerCase()+' ')>-1){rv=n.tagName.toLowerCase();}else{return false;}
return true;});return rv;};var ShareButton=function(op){var a=_doc.createElement("a");a.setAttribute("target","_blank");a.setAttribute("title","\u5206\u4EAB\u5230QQ\u7A7A\u95F4");if(Math.random()+_clickSendRate>1){a.onclick=function(){TCISD.sendPingHot('/qzshare.plus.pick.click|rate=1-'+parseInt(1/_clickSendRate));}}
_doc.body.insertBefore(a,_doc.body.childNodes[0]);this.dom=a;}
ShareButton.prototype={setStyle:function(style){var ostyle=["width:",style.width,"px;height:",style.height,"px;background:url(",style.bgp,");background-position: ",style.bgposX,"px ",style.bgposY,"px;background-color:transparent;text-decoration:none;position:absolute;padding:0;margin:0;border:0;top:0px;left:0px;display:none;z-index:",_shareButtonStyle.zIndex,";"].join('');this.width=style.width;this.height=style.height;this.dom.setAttribute("style",ostyle);this.dom.style.cssText=ostyle;},show:function(x,y){if(Math.random()+_showPvSendRate>1){TCISD.sendPV('/qzshare.plus.pick.show|rate=1-'+parseInt(1/_showPvSendRate));}
this.dom.style.display='inline-block';this.dom.style.left=(x||0)+'px';this.dom.style.top=(y||0)+'px';this.dom.style.position='absolute';this.dom.style.zIndex=_shareButtonStyle.zIndex;},hide:function(){this.dom.style.display="none";},setUrlParam:function(o){var params={},params2=[];for(var i in _urlparam){params[i]=_urlparam[i];}
for(var j in o){params[j]=o[j];}
for(var k in params){if(params[k]){params2.push(k+'='+(k=='pics'?params[k]:encodeURIComponent(params[k])));}}
this.dom.setAttribute("href",_proto+'//'+_host+_path+'?'+params2.join('&'));}}
var _onMouseUp=function(e){e=e||window.event;var target=e.target||e.srcElement,searResultStr;if(target!=_dragShareButton.dom&&(searResultStr=checkInArea(_getSelectionParentElement(),_textSearchRngReg))&&(_nowSelectionText=_getSelectionText()).length>=_minSelectionStrLength){var _e={"x":e.clientX,"y":e.clientY},_o={"w":_dragShareButton.dom.clientWidth||_dragShareButton.width,"h":_dragShareButton.dom.clientHeight||_dragShareButton.height},dd=document.documentElement||document.body,db=document.body,st=window.pageYOffset||dd.scrollTop||db.scrollTop||0,sl=window.pageXOffset||dd.scrollLeft||db.scrollLeft||0,x=(_e.x-_o.w-_dragSharePadX<0)?_e.x+_o.w+sl:_e.x-_o.w-_dragSharePadX+sl,y=(_e.y-_o.h-_dragSharePadY<0)?_e.y+st+_o.h:_e.y-_o.h-_dragSharePadY+st,op=option[_drag_pick_op_name];op=op[searResultStr]||{};op.desc=_nowSelectionText.substr(0,_maxDescLength);op.adtag='wordshare';_dragShareButton.setUrlParam(op);_dragShareButton.show(x,y);}};var _onMouseDown=function(e){e=e||window.event;var target=e.target||e.srcElement;if(target!=_dragShareButton.dom){if(_doc.selection){_doc.selection.empty();}else if(window.getSelection){window.getSelection().removeAllRanges();}
_dragShareButton.hide();_nowSelectionText='';}};var _onMouseOver=function(e){e=e||window.event;var target=e.target||e.srcElement,searResultStr;if(_currentMouseOverTarget==target||target==_imgShareButton.dom)return;if(target.tagName.toLowerCase()=='img'&&(searResultStr=checkInArea(target,_imgSearchRngReg))){var bound=target.getBoundingClientRect(),sw=_imgShareButton.width+_imgSharePadX,sh=_imgShareButton.height+_imgSharePadY;if(target.clientWidth>sw&&target.clientHeight>sh){var dd=document.documentElement||document.body,db=document.body,st=window.pageYOffset||dd.scrollTop||db.scrollTop||0,sl=window.pageXOffset||dd.scrollLeft||db.scrollLeft||0,op=option[_img_pick_op_name];op=op[searResultStr]||{};op.pics=encodeURIComponent(target.src);op.adtag='imgshare';_imgShareButton.setUrlParam(op);_imgShareButton.show(Math.min(bound.right,dd.clientWidth||db.clientWidth||bound.right)-sw+sl,Math.min(bound.bottom,dd.clientHeight||db.clientHeight||bound.bottom)-sh+st);}}else{_imgShareButton.hide();}
_currentMouseOverTarget=target;};var _getSelectionText=function(){return(_doc.selection?_doc.selection.createRange().text:_doc.getSelection()).toString().replace(/[\s\n]+/g," ");};var _getSelectionParentElement=function(){return _doc.selection?_doc.selection.createRange().parentElement():_doc.getSelection().getRangeAt(0).commonAncestorContainer;};if(document.body&&(/Chrome.(\d+\.\d+)/i.exec(navigator.userAgent)||window.chrome)){upDate();}else{Tool.dom.onDomReady(upDate);}
window.Tencent=window.Tencent||{};window.Tencent.shareButton={upDate:upDate};})(window._qzone_share_pick_cfg);